# Любовное послание

![](images/LoveLetter.jpg)

version 1.0.0

Текстовая игра _"Любовное послание"_ в виде бота для телеграма выполненного на python3.7.

## Установка и запуск
####Установка

```$ pip install loveletter```

####Запуск

Для того чтобы запустить бота требуется установить [телеграм](https://telegram.org/) и завести себе бота. Для этого достаточно написать в телеграм [@botfather](https://t.me/BotFather), он расскажет, что делать дальше, а в конце выдаст токен вашего бота (он выглядит примерно так `123456789:AAEaEMQlkqjLFEjklajklhCEWOHucAcidOH`).

Имея токен можно легко запустить бота:

```$ python -m bot --token='<token>'```

Если не хочестся каждый раз вводить токен руками или искать откуда его скопипастить, то также можно сохранить его в системе, в переменной окружения:

```$ export LOVELETTER_TOKEN='<token>'```

Тогда бота запускать будет значительно легче

```$ python -m bot```

Можно также вообще ничего не устанавливать, а воспользоваться готовым ботом [@loveletter_gamebot](https://t.me/loveletter_gamebot) который принадлежит автору этого репозитория. Впрочем автор не дает никаких гарантий, что бот будет в рабочем состоянии, когда вам захочется поиграть, поэтому, он постарался сделать так что деплой бота на произвольный компьютер, подключенный к интернету будет максимально прост.

## Правила игры

#### Колода
Это карточная игра в которой используется всего 8 карт:
* (8) Принцесса x1
* (7) Графиня x1
* (6) Король x1
* (5) Принц x2
* (4) Служанка x2
* (3) Барон x2
* (2) Священник x2
* (1) Стражница x5

Слева от карт указана их ценность, чем она больше &mdash;
тем больше шансов выиграть в конце раунда, так как из всех оставшихся игроков выигрывает тот,
у кого карта самая ценная. 
Справа указано число карт в стандартной колоде (всего их 16).

#### Начало игры
В начале игры карты перемешиваются,
и одна карта откладывается в сторону &mdash; 
она не будет участвовать в игре 
(так всегда остается интрига, какие карты остались в колоде), 
остальные карты расдаются игрокам по одной штуке, 
определяется порядок ходов и тот кто ходит берет себе еще одну карту.

Дальше игрок может выбрать какую из двух карт использовать. 
При этом несыгранная карта остается у него на руке, 
а сыгранная уходит в сброс, и применяется свойство этой карты.

#### Свойства карт
Ниже перечисленны свойства карт:
* **Принцесса** &mdash; если скинуть эту карту с руки, игрок моментально выбывает из игры.
При этом не важно скинул он ее сам, или же ему пришлось это сделать в результате действий
других игроков и их карт. С одной стороны эту карту очень опасно держать на руках, но если
удержать ее до конца раунда, обладатель этой карты становится безусловным победителем.
* **Графиня** &mdash; эту карту можно только скинуть с рук. Более того, если у игрока на руках второй картой 
оказывается **Король** или **Принц**, то игрок обязан играть **Графиней**. Учитывая что **Принцессу** он тоже не может скинуть
(если не хочет проиграть конечно), то **Графиня** это хороший индикатор того что у игрока на руке остается ценная карта (впрочем никто не запрещает блефовать и скидывать графиню с мелкими картами на руке).
* **Король** &mdash; скинув карту выберите другого игрока и обменяйтесь с ним картами, которые у вас на руках.
* **Принц** &mdash; выберите любого игрока (можно себя), он должен скинуть свою карту с руки и взять другую. Если у него была **Принцесса**, то он моментально проиграл, а если карт в колоде нет, то игрок берет ту которая была отложена в начале игры.
* **Служанка** &mdash; сыграв эту карту, игрок становится полностью защищенным от эффектов других карт. Иногда бывает так что все игроки защищены служанкой, а кто то хочет применить карту требующую выбора игрока, тогда он применяет ее на себя (по умолчанию на себя можно применять только карту **Принца**)
* **Барон** &mdash; сыграв барона выберите игрока, и сравните ваши с ним карты на руках. Тот у кого карта слабее &mdash; выходит из игры. Если же карты одинаковые, ничего не происходит, **Барон** уходит впустую.
* **Священник** &mdash; скинув карту игрок может посмотреть карту любого другого игрока, при этом она не раскрывается всем остальным игрокам.
* **Стражница** &mdash; сбросив карту можете выбрать любого игрока и угадать, что у него за карта, если угадаете &mdash; игрок выходит из игры.

#### Цель
Игра продолжается пока не останется один игрок, либо закончатся карты.
Среди игроков, которые остаются к концу игры, выигрывает тот, у кого оставшаяся карта на руке.
Таким образом можно выбрать любую стратегию поведения, начиная от вариата "побыстрее выкинуть всех игроков из игры и остаться последним", заканчивая таким что игрок всю игру не подает вида и держит на руках **Прицессу**.

[Полные правила игры в переводе от hobby world](https://hobbyworld.ru/download/rules/ll_rules.pdf)

## Взаимодействие с ботом
У бота есть несколько команд:
* /help - помощь по командам
* /create - создать новую игру в чате
* /join - присоединиться к игре
* /start - начать игру
* /cards - показать сброшенные карты
* /players - показать список игроков
* /hint - показать краткое описание свойств карт
* /doubledeck - добавить в игру вторую колоду (полезно, если игроков больше 5)

Для того чтобы начать играть, требуется создать чатик и пригласить туда всех игроков а также саомого бота. В чате требуется создать игру `/create`, и присоединиться всем игрокам, которые хотят играть, для этого каждый должен послать команду `/join`. Как только все будут готовы играть, любой из участников должен отправить команду `/start`. После этой команды начнется игра, и изменение числа участников или добавление второй колоды будут недействительны. В процессе игры бот будет присылать сообщения о том, какие карты у вас на руказ в личный чат*, а сообщения о том кто какими картами сделал ход и что это при этом произошло &mdash; в общий чат. При этом все ходы производятся в личном чате, посредством текстовых сообщений 

---
\* тут стоит отметить, что телеграм не позволяет ботам писать произвольным пользователям, поэтому для того чтобы начать получать от него сообщения, каждый участник игры должен сначала "познакомиться" с ботом, и прислать ему произвольное сообщение в личный чат.
